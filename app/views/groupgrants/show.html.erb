<!-- Facebook SDK -->
<div id="fb-root"></div>

<div class="row">
<div class="col-md-1">
<!-- I made this so things would be centered -->
</div>
	<div class = "col-md-5">
    <div class="text-center gg_title">
      <!-- gG Title -->
      <h1><strong><%= @groupgrant.name %><strong><br/><small><em> started by <%= @groupgrant.charity.name%></em></small></h1>
    </div>
    <!-- gG Description -->
    <p class="lead">
      <%= @groupgrant.description %>
    </p>
	</div>
  <!-- gG Info -->
	<div class= "col-md-5">
    <div class= "well">
      <div>
        <%= image_tag @groupgrant.groupgrant_pic.url(:small), class: "gg_image col-md-3", style:":block;" %>
      </div>
      <div> 
      <!-- Time remaining -->
        <strong>
           <%= distance_of_time_in_words(Time.now, @groupgrant.goal_date)  %> left
        </strong>
      </div>
      <div class="row">
      <!-- gG Progress Bar -->
        <div class="col-sm-4 center-block">
          <%= number_to_currency(@groupgrant.goal_status, :precision => 0, :delimiter => ',') %> RAISED 
        </div>
        <div class="col-sm-4 center-block">
          <input type="text" value=<%=@groupgrant.progress%> class="dial" readOnly="true">
        </div>
        <div class="col-sm-4 center-block">
          <%= number_to_currency(@groupgrant.goal_amount, :precision => 0, :delimiter => ',') %> GOAL
        </div>
      </div>
      </br>
      <div>
        <!-- Button trigger modal -->
        <a button class="btn btn-primary btn-lg btn-block" data-toggle="modal" data-target=".payment-form">Donate</button></a> 
          <div class="modal fade payment-form" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Make a Donation</h4>
                </div>
                <form action="/groupgrants/submit_payment" method="POST" id="payment-form">
                  <span class="payment-errors"></span>
                  <div class="modal-body">
                    <div class="form-row">
                      <label>
                        <span>Donation Ammount</span>
                        <br>
                        <input type="text" size="20" data-stripe="amount" id="amount" name="amount"/>
                      </label>
                    </div>

                    <div class="form-row">
                      <label>
                        <br>
                        <span>Card Number</span>
                          <br>
                          <input type="text" size="20" data-stripe="number" placeholder="••••  ••••  ••••  ••••"/>
                      </label>
                    </div> 

                    <div class="col-md-8">
                      <div class="col-md-8">
                        <div class="form-row">
                          <label>
                            <br>
                            <span>Expiration (MM/YYYY)</span>
                            <br>
                            <input type="text" size="2" data-stripe="exp-month" placeholder="• •"/>
                            <span> / </span>
                            <input type="text" size="4" data-stripe="exp-year" placeholder="• • • •"/>
                          </label>
                        </div> 
                      </div>

                      <div class="col-md-4">
                        <div class="form-row">
                          <label>
                            <br>
                            <span>CVC</span>
                            <br>
                            <input type="text" size="4" data-stripe="cvc" placeholder="• • •"/>
                          </label>
                        </div> 
                      </div>
                    </div>              
                  </div>

                  <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Donate Now</button>                         
                  </div>                   
                </form>
              </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
          </div><!-- /.modal -->
      </div>
      <div  class="partnerships">
      <!-- Charity and Business information -->
        <div style="clear:both;">
          <%= image_tag @groupgrant.charity.charity_pic.url(:small), style:"width:50px;" %>
        </div>
      </div>
</div>

    <div class = "social-media-icons automargin">
    <!-- Social Media -->
      <h3><em>Share the cause </em></h3>
      <table>
        <tr>
           <td>
              <!-- Show Tweet Button -->
              <div id="tweets"></div>
              
           </td>
        </tr>
        <tr>
           <td>
              <!-- Show Facebook button -->
              <div id="sharePage"></div>
           </td>
        </tr>
      </table>
    </div>
  </div>
</div>

<div class="col-md-1">
<!-- I made this so things would be centered -->
</div>

<div id="sponsors">
  <% if user_signed_in? && current_user.rolable_type == "Business" && @groupgrant.partner_id == 0 %>
  <% r = Request.where(groupgrant_id: @groupgrant.id)
    #check if this is the user that sent it
    if (r[0] != nil)
      r = Request.find(r)
      m = Message.where(request_id: r.id)
      m = Message.find(m)
  
      if (m.user_sent_id == current_user.id) %>
        <div class="btn btn-primary" id="cancel" data-groupgrant=<%=@groupgrant.id %> >
           Request Pending. Cancel? 
        </div>
      <% end %>
      <% else %>
        <div id="request" class="btn btn-primary" data-groupgrant=<%=@groupgrant.id %> >
          Connect with Charity 
        </div>
    <% end %>
  <% end %>
</div>

<%= javascript_include_tag("https://js.stripe.com/v2/") %>
<%= javascript_include_tag("stripe.js") %>
<%= javascript_include_tag("jquery.knob.js") %>
<%= javascript_include_tag("facebook_twitter_api.js") %>
